<?xml version="1.0" encoding="utf-8"?>
<modification>
  <name>SELF Modification</name>
  <code>default</code>
  <version>1.0</version>
  <author>Howard Yang</author>
  <link>http://www.opencart.com</link>
  <file path="admin/view/template/sale/customer_form.tpl">
    <operation>
      <search><![CDATA[<li><a href="#tab-ip" data-toggle="tab"><?php echo $tab_ip; ?></a></li>]]></search>
      <add position="after">
        <![CDATA[<li><a href="#tab-tree" data-toggle="tab">小資男女</a></li>]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[<div class="tab-pane" id="tab-ip">]]></search>
      <add position="before">
        <![CDATA[
<div class="tab-pane" id="tab-tree">
  <div id="tree">
  </div>
</div>
        ]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[$('#transaction').load('index.php?route=sale/customer/transaction&token=<?php echo $token; ?>&customer_id=<?php echo $customer_id; ?>');]]></search>
      <add position="after">
        <![CDATA[
$('#tree').load('index.php?route=sale/tree&token=<?php echo $token; ?>&customer_id=<?php echo $customer_id; ?>');
        ]]>
      </add>
    </operation>
  </file>
  <file path="catalog/controller/account/account.php">
    <operation>
      <search><![CDATA[$data['wishlist'] = $this->url->link('account/wishlist');]]></search>
      <add position="after">
        <![CDATA[$data['tree'] = $this->url->link('account/tree');]]>
      </add>
    </operation>
  </file>
  <file path="catalog/view/theme/*/template/account/account.tpl">
    <operation>
      <search><![CDATA[<li><a href="<?php echo $wishlist; ?>"><?php echo $text_wishlist; ?></a></li>]]></search>
      <add position="after">
        <![CDATA[<li><a href="<?php echo $tree; ?>">PV</a></li>]]>
      </add>
    </operation>
  </file>
  <file path="admin/view/template/catalog/product_form.tpl">
    <operation>
      <search><![CDATA[<li><a href="#tab-design" data-toggle="tab"><?php echo $tab_design; ?></a></li>]]></search>
      <add position="after">
        <![CDATA[<li><a href="#tab-bonus" data-toggle="tab">紅利回饋</a></li>]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[<div class="tab-pane" id="tab-design">]]></search>
      <add position="before">
        <![CDATA[
<div class="tab-pane" id="tab-bonus">
</div>
        ]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[$('input[name=\'manufacturer\']').autocomplete({]]></search>
      <add position="before">
        <![CDATA[
$('#tab-bonus').load('index.php?route=catalog/product_bonus&token=<?php echo $token; ?>&product_id=<?php echo $this->request->get['product_id']; ?>');
        ]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[<input type="text" name="price" value="<?php echo $price; ?>" placeholder="<?php echo $entry_price; ?>" id="input-price" class="form-control" />]]></search>
      <add position="after" offset="2">
        <![CDATA[
<div class="form-group">
  <label class="col-sm-2 control-label" for="input-price">回饋金額</label>
  <div class="col-sm-10">
    <input type="text" name="bonus" value="<?php echo $bonus; ?>" placeholder="回饋金額" id="input-bonus" class="form-control" />
  </div>
</div>
        ]]>
      </add>
    </operation>
  </file>
  <file path="admin/controller/catalog/product.php">
    <operation>
      <search><![CDATA[if (isset($this->request->post['price'])) {]]></search>
      <add position="before">
        <![CDATA[
$this->load->model('catalog/hook');
$product_object = $this->model_catalog_hook->productInfo($this->request->get['product_id']);

if (isset($this->request->post['bonus'])) {
  $data['bonus'] = $this->request->post['bonus'];
} elseif (!empty($product_info)) {
  $data['bonus'] = $product_object->bonus;
} else {
  $data['bonus'] = '';
}
        ]]>
      </add>
    </operation>
    <operation>
      <search><![CDATA[$this->model_catalog_product->editProduct($this->request->get['product_id'], $this->request->post);]]></search>
      <add position="after">
        <![CDATA[
$this->load->model('catalog/hook');
$this->model_catalog_hook->productSave($this->request->get, $this->request->post);
        ]]>
      </add>
    </operation>
  </file>
  <file path="admin/controller/common/menu.php">
    <operation>
      <search><![CDATA[$this->load->language('common/menu');]]></search>
      <add position="after"><![CDATA[
        $data['level'] = $this->url->link('sale/level', 'token=' . $this->session->data['token'], 'SSL');
        ]]></add>
      </operation>
    </file>

    <file path="admin/view/template/common/menu.tpl">
      <operation>
        <search><![CDATA[<li><a class="parent"><?php echo $text_voucher; ?></a>]]></search>
        <add position="before"><![CDATA[
          <li><a href="<?php echo $level; ?>">會員等級管理</a></li>
        ]]></add>
      </operation>
    </file>
</modification>